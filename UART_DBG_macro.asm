//////////////////////////////////////////////////////////////////////////////
////////////              Create by S.P.S 2015(c)         		 /////////////
//////////////////////////////////////////////////////////////////////////////
////////////                                                     /////////////
////////////    			 SPS UART DEBUGGER                   /////////////
////////////                                                     /////////////
//////////////////////////////////////////////////////////////////////////////
////////////                                                     /////////////
////////////                Библиотека макросов                  /////////////  
////////////                                                     /////////////
//////////////////////////////////////////////////////////////////////////////
////////////                                                     /////////////
////////////     Тут находятся все макросы используемые для      /////////////
////////////     отладки через UART и диагностики            	 /////////////
////////////                                                     /////////////
//////////////////////////////////////////////////////////////////////////////
////////////                                                     /////////////
////////////     Расположение: После определения стека           /////////////
////////////     Код вставки: .include "UART_DBG_macro.asm"      /////////////
////////////                                                     /////////////
//////////////////////////////////////////////////////////////////////////////


;--------------------------------------------------------------
; DBG_CHAR 
;--------------------------------------------------------------
;Вывод ASCII-символа в терминал

	.MACRO	DBG_CHAR
		CLI						; Запрещаем прерывания
		PUSH	R16				; Запихиваем в стек регистр
		LDI		R16,@0			; Присваиваем ему наш символ
		SBIS 	UCSRA,UDRE		; Пропуск если нет флага готовности
		RJMP	PC-1 			; ждем готовности - флага UDRE
 		OUT		UDR, R16 		; шлем байт	
		POP		R16				; Возвращаем все на место
		SEI		                ; Разрешаем прерывания
	.ENDM

;ПРИМЕР: (DBG_CHAR 'A')
;			1	    2  
;1 - Название макроса
;2 - Символ в ASCII заключенный в одинарные ковычки
;--------------------------------------------------------------

;--------------------------------------------------------------
; DBG_REG
;--------------------------------------------------------------
; Вывод значение регистра в терминал

 //// Тут будет код

;ПРИМЕР: ( DBG_REG )
;		   1 2  
;1 - 
;2 - 
;--------------------------------------------------------------

;--------------------------------------------------------------
; BN_POINT 
;--------------------------------------------------------------
; Брейкпоинт с номером. Выводит в терминал слово "Breake-N"

 //// Тут будет код

;ПРИМЕР: ( BN_POINT )
;		   1 2  
;1 - 
;2 - 
;--------------------------------------------------------------

;--------------------------------------------------------------
; DBG_START 
;--------------------------------------------------------------
; Выводит в терминал символ "+", для отслеживания рестарта

 //// Тут будет код

;ПРИМЕР: ( DBG_START )
;		   1 2  
;1 - 
;2 - 
;--------------------------------------------------------------

//////////////////////////////////////////////////////////////////////////////
